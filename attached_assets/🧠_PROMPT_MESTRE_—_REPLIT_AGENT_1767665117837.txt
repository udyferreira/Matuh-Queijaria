üß† PROMPT MESTRE ‚Äî REPLIT AGENT
(Backend do Agente de Produ√ß√£o ‚Äì Queijo Nete v1.0)
Contexto do projeto
Voc√™ est√° criando um backend server-side para um agente de IA que acompanha a produ√ß√£o artesanal de queijos, com intera√ß√£o por voz via Alexa.
O backend deve:
controlar rigorosamente o processo produtivo,
calcular propor√ß√µes,
gerenciar timers e lembretes,
armazenar medi√ß√µes (pH, hor√°rios),
usar um LLM apenas como apoio cognitivo, nunca como executor do processo.
Existe um modelo can√¥nico congelado (v1.0) da receita do Queijo Nete, que n√£o pode ser alterado.
Stack t√©cnica desejada
Linguagem: Python
Framework HTTP: FastAPI
Execu√ß√£o: servidor web (pronto para ser exposto via HTTPS)
Persist√™ncia (MVP): SQLite ou Replit DB
LLM: integra√ß√£o via API (OpenAI ou compat√≠vel)
Arquitetura: determin√≠stica + LLM supervisionado
Regras arquiteturais obrigat√≥rias
1. Separa√ß√£o de responsabilidades
O backend √© soberano sobre:
ordem das etapas
c√°lculos
timers
valida√ß√µes
O LLM nunca pode:
calcular propor√ß√µes
avan√ßar etapas
pular etapas
alterar timers
sobrescrever medi√ß√µes humanas
2. Uso do LLM
O LLM deve ser usado somente para:
interpretar linguagem natural amb√≠gua
explicar etapas
refor√ßar cuidados do processo
emitir alertas e lembretes verbais
Implementar tool-calling:
o LLM apenas sugere inten√ß√µes
o backend decide e executa
Modelo can√¥nico da receita (IMUT√ÅVEL)
Carregue a receita Queijo Nete v1.0 a partir de um arquivo YAML interno do projeto.
Ela cont√©m 20 etapas, incluindo:
c√°lculo de fermentos (LR, DX, KL, Coalho)
timers cr√≠ticos (30 min, 8 horas, 36 horas, di√°rio)
registros obrigat√≥rios:
volume de leite
hor√°rio de flocula√ß√£o
hor√°rio de ponto de corte
medi√ß√µes de pH
hor√°rio de in√≠cio da prensa
O backend deve executar exatamente essas etapas, nessa ordem.
Modelo de estado do lote (obrigat√≥rio)
Crie uma estrutura persistente chamada ProductionBatch contendo, no m√≠nimo:
batch_id
recipe_id
current_stage_id
milk_volume_l
calculated_inputs (fermentos, coalho)
timestamps:
flocculation_time
cut_point_time
press_start_time
ph_measurements (lista com timestamp + valor)
active_timers
status (active | paused | completed)
Endpoints HTTP obrigat√≥rios
Crie endpoints REST claros e documentados:
POST /batch/start
inicia um novo lote
recebe volume de leite
POST /batch/{id}/advance
tenta avan√ßar para a pr√≥xima etapa
valida regras antes de permitir
POST /batch/{id}/input
registra entradas humanas (pH, hor√°rios)
GET /batch/{id}/status
retorna etapa atual, timers ativos e pr√≥ximos passos
POST /alexa/webhook
endpoint para integra√ß√£o com Alexa Skill
recebe texto interpretado
responde texto para fala
Comportamento esperado do backend
Nunca permitir avan√ßo fora de ordem
Bloquear etapas enquanto timers n√£o expirarem
Registrar todos os eventos importantes
Sempre informar:
etapa atual (ex: ‚Äúetapa 10 de 20‚Äù)
pr√≥xima a√ß√£o esperada
Ser resiliente a chamadas repetidas (idempotente)
Observabilidade m√≠nima
Logar:
in√≠cio e fim de cada etapa
timers criados e conclu√≠dos
erros de valida√ß√£o
Estruturar logs para futura an√°lise
O que gerar agora
Estrutura completa do projeto
C√≥digo funcional do backend
Loader do YAML da receita
Modelo de estado do lote
Integra√ß√£o inicial com LLM (com fun√ß√µes bem delimitadas)
Endpoint pronto para Alexa
N√£o gerar c√≥digo fict√≠cio ou ‚ÄúTODOs‚Äù cr√≠ticos.
O projeto deve subir e rodar.
Objetivo final
Este backend ser√° usado em produ√ß√£o por funcion√°rios da queijaria.
Previsibilidade, clareza e seguran√ßa s√£o mais importantes do que criatividade.