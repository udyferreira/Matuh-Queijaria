PROMPT PARA O REPLIT ‚Äî LIMPEZA DO INTERPRETADOR + PREPARO PARA LLM
Contexto
O backend recebe comandos de voz da Alexa como texto livre via ProcessCommandIntent.
Atualmente existe um interpretador manual (regex, if/else, heur√≠sticas) tentando entender os comandos, o que est√° causando fallback constante (‚ÄúN√£o ouvi o comando.‚Äù).
Vamos remover esse interpretador manual e preparar a arquitetura para uso de um LLM como interpretador, mantendo o backend soberano.
1. Limpeza obrigat√≥ria (sem quebrar o sistema)
Remover TODA l√≥gica de interpreta√ß√£o manual de linguagem natural, incluindo:
regex de comandos
if/else baseados em palavras como ‚Äústatus‚Äù, ‚Äúavan√ßar‚Äù, etc.
qualquer tentativa de ‚Äúentender‚Äù o texto no webhook
Manter intacto:
o fluxo do /api/alexa/webhook
valida√ß√µes de etapa
regras de bloqueio do processo
fallback falado
buildAlexaResponse
üëâ Importante:
N√£o apagar o fluxo. Trocar apenas o c√©rebro.
2. Criar servi√ßo interno de interpreta√ß√£o (ainda sem prompt)
Criar uma fun√ß√£o/servi√ßo interno, por exemplo:
interpretCommand(text: string)
Por enquanto, essa fun√ß√£o pode:
apenas lan√ßar um TODO
ou retornar algo fixo de teste
Exemplo tempor√°rio aceit√°vel:
{
  "intent": "unknown",
  "confidence": 0.0,
  "entities": {}
}
‚ö†Ô∏è O webhook da Alexa n√£o deve conter l√≥gica sem√¢ntica.
3. Preparar integra√ß√£o com OpenAI (sem ativar ainda)
Adicionar depend√™ncia oficial da OpenAI
Preparar client usando:
API key via vari√°vel de ambiente
N√£o definir ainda o prompt
N√£o chamar a OpenAI diretamente do webhook
A chamada √† OpenAI deve ficar isolada dentro de interpretCommand
4. Contrato can√¥nico do interpretador (obrigat√≥rio)
Definir e documentar que interpretCommand SEMPRE retorna:
{
  "intent": "status | input | advance | help | unknown",
  "confidence": 0.0,
  "entities": {}
}
Regras:
intent = unknown √© v√°lido
Backend decide o que fazer
LLM nunca executa a√ß√£o
LLM nunca valida processo
5. Crit√©rio de aceite
Considere correto quando:
Nenhuma l√≥gica de NLP manual existir no backend
O webhook da Alexa apenas:
extrai texto
chama interpretCommand
executa ou bloqueia
A integra√ß√£o OpenAI estiver preparada, mas ainda neutra
O sistema continuar funcionando (mesmo retornando fallback)