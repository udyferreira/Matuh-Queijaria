üîß PROMPT PARA CORRE√á√ÉO DEFINITIVA DO WEBHOOK ALEXA
Contexto obrigat√≥rio (leia com aten√ß√£o)
A Alexa Skill N√ÉO utiliza m√∫ltiplos intents estruturados.
Ela utiliza APENAS UM intent gen√©rico (ProcessCommandIntent) com UM slot livre (AMAZON.SearchQuery), conforme j√° configurado no Alexa Developer Console.
A Alexa √© somente interface de voz.
TODA decis√£o de processo √© feita no backend can√¥nico.
1. Corrigir o modelo de intents assumido pelo backend
Fa√ßa os seguintes ajustes obrigat√≥rios:
‚ùå Remover qualquer depend√™ncia de:
StartBatchIntent
StatusIntent
AdvanceIntent
LogPHIntent
Qualquer outro intent espec√≠fico
‚úÖ O backend deve aceitar somente:
LaunchRequest
IntentRequest com:
intent.name = "ProcessCommandIntent"
slots.utterance.value = "<texto livre>"
2. Novo contrato correto do /api/alexa/webhook
Documentar e implementar exclusivamente este fluxo:
LaunchRequest
Responder mensagem de boas-vindas
Nunca tentar interpretar comando
shouldEndSession = false
IntentRequest
Extrair:
utterance (texto falado completo)
Encaminhar para o interpretador do backend
O backend decide:
consultar status
registrar input
tentar avan√ßar
bloquear a√ß√£o
A Alexa apenas fala a resposta recebida
3. Padroniza√ß√£o obrigat√≥ria da resposta Alexa
Criar e usar uma √∫nica fun√ß√£o utilit√°ria:
{
  "version": "1.0",
  "response": {
    "outputSpeech": {
      "type": "PlainText",
      "text": "<texto vindo do backend can√¥nico>"
    },
    "shouldEndSession": false
  }
}
Regras:
‚ùå Nunca retornar JSON interno ({ speech: ... })
‚ùå Nunca retornar HTTP 4xx ou 5xx
‚úÖ Sempre HTTP 200
‚ùå Nunca calcular propor√ß√µes no webhook
‚ùå Nunca avan√ßar etapas no webhook
4. Documenta√ß√£o a ser atualizada
Gerar nova documenta√ß√£o contendo:
Payload real recebido da Alexa (com ProcessCommandIntent)
Exemplo real:
{
  "intent": {
    "name": "ProcessCommandIntent",
    "slots": {
      "utterance": {
        "value": "registra pH cinco ponto dois"
      }
    }
  }
}
Fluxo:
Fala ‚Üí Backend interpreta ‚Üí Backend executa ‚Üí Alexa fala
Remover qualquer men√ß√£o a intents espec√≠ficos
5. Crit√©rio de aceite
Considere correto somente quando:
‚ÄúAlexa, abrir matuh queijaria‚Äù funciona
Qualquer frase livre chega no backend
Nenhuma l√≥gica de processo existe na Alexa
O backend permanece soberano
O webhook vira apenas um adaptador de voz